[tox]
envlist = py27,py36
skipsdist=True

[testenv]
passenv = *
setenv = 
    PYTHONPATH = {toxinidir}
    PYTHONIOENCODING=utf-8

deps=
    -rrequirements.txt

install_commands = 
commands=
    # Run code format check.
    flake8 .
    
    # Run unit tests with code coverage.
    pytest --cov-report xml --cov mssqlscripter

    # Build mssql-scripter sdist.
    python setup.py sdist

    # Build mssqltoolsservice wheel and install mssq-scripter.
    python verify_packaging.py clean

    python -m mssqlscripter -h
